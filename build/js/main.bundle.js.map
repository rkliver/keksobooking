{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack://keksobooking/./source/js/create-fetch.js","webpack://keksobooking/./source/js/create-popup.js","webpack://keksobooking/./source/js/map-filter.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/file.js","webpack://keksobooking/./source/js/form.js"],"sourcesContent":["// AJAX запрос данных об объявлениях неподалеку\nconst getData = (onSuccess, onError) => () => {\n  return fetch('https://26.javascript.pages.academy/keksobooking/data')\n    .then(response => {\n      if(response.ok) {\n        return response.json();\n      }\n      throw new Error(`${response.status} ${response.statusText}`);\n    })\n    .then((json) => {\n      onSuccess(json);\n    })\n    .catch(() => {\n      onError();\n    });\n};\n// отправляет данные объявления пользователя из формы на сервер\nconst sendData = (onSuccess, onFail, body) => {\n  fetch('https://26.javascript.pages.academy/keksobooking',\n    {\n      method: 'POST',\n      body,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        onSuccess();\n        // Вы можете раскомментировать соедующие строки, чтобы увидеть отправленные данные:\n        // for (let [key, value] of body) {\n        //   console.log(`${key} - ${value}`)\n        // }\n      } else {\n        onFail('Проверьте введённые данные.');\n      }\n    },\n\n    )\n    .catch((err) => {\n      onFail(err.message);\n    })\n}\nexport{getData, sendData};\n","const AdsNearbyTemplate = document.querySelector('#card').content.querySelector('.popup');\n\n//функция принимает данные объявления и возвращает HTML элемент для отображения в качестве popup\nconst createPopup = (adNearby) => {\n  const adsNearbyListElement = AdsNearbyTemplate.cloneNode(true);\n\n  adsNearbyListElement.querySelector('.popup__title').textContent = adNearby.offer.title;\n\n  adsNearbyListElement.querySelector('.popup__text--address').textContent = adNearby.offer.address;\n\n  adsNearbyListElement.querySelector('.popup__text--price').textContent = adNearby.offer.price + ' ₽/ночь';\n\n  switch(adNearby.offer.type){\n    case 'flat':\n      adsNearbyListElement.querySelector('.popup__type').textContent = 'Квартира';\n      break\n    case 'bungalow':\n      adsNearbyListElement.querySelector('.popup__type').textContent = 'Бунгало';\n      break\n    case 'house':\n      adsNearbyListElement.querySelector('.popup__type').textContent = 'Дом';\n      break\n    case 'palace':\n      adsNearbyListElement.querySelector('.popup__type').textContent = 'Дворец';\n      break\n  }\n  adsNearbyListElement.querySelector('.popup__text--capacity').textContent = 'Количество комнат: ' + adNearby.offer.rooms  + ' для ' + adNearby.offer.guests + ' гостей';\n\n  adsNearbyListElement.querySelector('.popup__text--time').textContent = 'Заезд после ' + adNearby.offer.checkin + ', выезд до ' + adNearby.offer.checkout;\n\n  adsNearbyListElement.querySelector('.popup__features').querySelectorAll('.popup__feature').forEach((element) => {element.remove()});\n  if (adNearby.offer.features !== undefined){\n    for (let i = 0; i < adNearby.offer.features.length; i++){\n      let featureOne = document.createElement('li');\n      featureOne.textContent = adNearby.offer.features[i];\n      featureOne.classList.add('popup__feature','popup__feature--' + adNearby.offer.features[i]);\n      adsNearbyListElement.querySelector('.popup__features').appendChild(featureOne);}\n  }\n\n  adsNearbyListElement.querySelector('.popup__description').textContent = adNearby.offer.description;\n\n  adsNearbyListElement.querySelector('.popup__photos').querySelectorAll('.popup__photo').forEach((element) => {element.remove()});\n  if (adNearby.offer.photos !== undefined){\n    for (let i = 0; i < adNearby.offer.photos.length; i++){\n      let photoOne = document.createElement('img');\n      photoOne.src = adNearby.offer.photos[i];\n      photoOne.classList.add('popup__photo');\n      photoOne.width = '45';\n      photoOne.height = '40';\n      photoOne.alt = 'Фотография жилья';\n      adsNearbyListElement.querySelector('.popup__photos').appendChild(photoOne);}\n  }\n\n  adsNearbyListElement.querySelector('.popup__avatar').src = adNearby.author.avatar;\n\n  for (let i = 1; i < adsNearbyListElement.children.length; i++){\n    if (adsNearbyListElement.children[i].textContent === ''){\n      adsNearbyListElement.children[i].classList.add('hidden');\n    }\n  }\n\n  return adsNearbyListElement;\n}\nexport {createPopup};\n","const defaultValue = 'any';\nconst MAX_MARKERS_COUNT = 10;\n\nconst housingTypeElement = document.querySelector('#housing-type');\nconst housingPriceElement = document.querySelector('#housing-price');\nconst housingRoomsElement = document.querySelector('#housing-rooms');\nconst housingGuestsElement = document.querySelector('#housing-guests');\nconst housingFeaturesElement = document.querySelector('#housing-features');\n\n//фильтр типа жилья\nconst checkHousingType = (ad) => {\n  if (housingTypeElement.value === defaultValue) {\n    return true;\n  }\n  return ad.offer.type === housingTypeElement.value;\n};\n\n//фильтр цены за ночь\nconst checkHousingPrice = (ad) => {\n  const priceFilterOptions = {\n    'any': ad.offer.price,\n    'middle': ad.offer.price > 10000 && ad.offer.price < 50000,\n    'low': ad.offer.price < 10000,\n    'high': ad.offer.price > 50000,\n  };\n  return priceFilterOptions[housingPriceElement.value];\n};\n\n//фильтр кол-ва комнат\nconst checkHousingRooms = (ad) => {\n  if (housingRoomsElement.value === defaultValue) {\n    return true;\n  }\n  return String(ad.offer.rooms) === housingRoomsElement.value;\n};\n\n// фильтр кол-ва гостей\nconst checkHousingGuests = (ad) => {\n  if (housingGuestsElement.value === defaultValue) {\n    return true;\n  }\n  return String(ad.offer.guests) === housingGuestsElement.value;\n};\n\n//фильтр доступных удобств\nconst checkHousingFeatures = (ad) => {\n  const checkedFeatures = housingFeaturesElement.querySelectorAll('input:checked');\n  const checkedList = [];\n  checkedFeatures.forEach((input) => checkedList.push(input.value));\n  if (checkedList.length === 0) {\n    return true;\n  }\n  const offer = ad.offer;\n  if (Object.keys(offer).includes('features')) {\n    const offerFeatures = offer.features;\n    return checkedList.every((feature) => offerFeatures.includes(feature));\n  }\n};\n\n// функция, принимает объявление и фильтрует согласно выбранным параметрам. Возвращает массив отфильтрованных объявлений\nconst filterAds = (ads) => {\n  const filteredAds = [];\n  for (const ad of ads) {\n    if (filteredAds.length >= MAX_MARKERS_COUNT) {\n      break;\n    }\n    if (\n      checkHousingType(ad)\n      && checkHousingPrice(ad)\n      && checkHousingRooms(ad)\n      && checkHousingGuests(ad)\n      && checkHousingFeatures(ad)\n    ) {\n      filteredAds.push(ad);\n    }\n  }\n  return filteredAds;\n};\n\nexport {filterAds};\n","import {getData} from './create-fetch.js';\nimport {createPopup} from './create-popup.js';\nimport {showAlert} from './util.js';\nimport {filterAds} from './map-filter.js';\n\n/* global L:readonly */\n/* global _:readonly */\n\nconst adForm = document.querySelector('.ad-form');\nconst mapFilter = document.querySelector('.map__filters');\n\n//Функция переводит страницу в нактивное состояние, если передать в нее что-то кроме true\nconst inactivateState = (boolean) => {\n  if (boolean !== true) {\n    adForm.classList.add('ad-form--disabled');\n    for(let i = 0; i < adForm.children.length; i ++){\n      adForm.children[i].setAttribute('disabled', true);\n    }\n    mapFilter.classList.add('ad-form--disabled');\n    for(let i = 0; i < mapFilter.children.length; i ++){\n      mapFilter.children[i].setAttribute('disabled', true);\n    }\n  }\n}\n\n//Отрисовывем карту\nconst map = L.map('map-canvas')\n  .on('load', () =>{\n    //при успешной загрузке карты активируем форму и фильтр карты\n    inactivateState(true);\n  })\n  .setView({\n    lat: 35.6895,\n    lng: 139.692,\n  }, 14);\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\n\n//Добавляем главную метку\nconst mainMarkerIcon = L.icon({\n  iconUrl: '/leaflet/img/main-pin.svg',\n  iconSize: [40, 40],\n  iconAnchor: [20, 52],\n});\n\nconst mainMarker = L.marker(\n  {\n    lat: 35.68950,\n    lng: 139.6920,\n  },\n  {\n    draggable: true,\n    icon: mainMarkerIcon,\n  },\n);\nmainMarker.addTo(map);\n\nmainMarker.on('moveend', (evt) => {\n  let x = evt.target.getLatLng().lat;\n  let y = evt.target.getLatLng().lng;\n  const address = adForm.querySelector('#address');\n  address.value = `${x.toFixed(5)}, ${y.toFixed(5)}`;\n});\n\n// Добавляем метки \"похожих объявлений\"\nconst markerBuilder = _.debounce(getData((adsNearby) => {\n  let filtredAds = filterAds(adsNearby);\n  const nearbyMarkerIcon = L.icon({\n    iconUrl: '/leaflet/img/pin.svg',\n    iconSize: [40, 40],\n    iconAnchor: [52, 52],\n  });\n  filtredAds.forEach((ad) => {\n    {\n      const marker = L.marker({\n        lat: ad.location.lat,\n        lng: ad.location.lng,\n      },\n      {\n        icon: nearbyMarkerIcon,\n      });\n      marker\n        .addTo(map)\n        .bindPopup(createPopup(ad));\n\n      mapFilter.addEventListener('change', () =>{\n        marker.remove();\n      })\n    }\n\n  })\n}, () => showAlert('Произошла ошибка при загрузке данных с сервера')), 500)\n\n//отрисовывваем метки если все успешно загрузилось\nwindow.addEventListener('load', () => {\n  markerBuilder();\n})\n//меняем метки согласно значений фильтра\nmapFilter.addEventListener('change', () =>{\n  markerBuilder();\n})\n\n\nexport {map, mainMarker, mapFilter, markerBuilder};\n","/* следующие функции требовались в ходе разработки по учебному заданию, но впоследствии были убраны из кода:\nФункция, возвращающая случайное целое число из переданного диапазона включительно. //\nconst getRandomInt = (min,max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  if (min < 0 || max < 0){\n    return -1;\n  }\n  if (max < min){\n    [min, max] = [max, min];\n  }\n  return Math.floor(Math.random() * (max - min + 1) + min);\n};\n\nФункция, возвращающая случайное число с плавающей точкой из переданного диапазона включительно.//\nconst getRandonFloat = (min, max, decimals) => {\n  if (min < 0 || max < 0){\n    return -1;\n  }\n  if (max < min){\n    [min, max] = [max, min];\n  }\n  const i = (Math.random() * (max - min) + min).toFixed(decimals)\n  return Number(i);\n};\n\nФункция, возвращающая случайный элемент массива.//\nconst getRandomArrayElement = (elements) => {\n  return elements[getRandomInt(0, elements.length - 1)];\n};\n*/\n\nconst showAlert = (message) => {\n  const alertContainer = document.createElement('div');\n  alertContainer.style.zIndex = 100;\n  alertContainer.style.position = 'absolute';\n  alertContainer.style.left = 0;\n  alertContainer.style.top = 0;\n  alertContainer.style.right = 0;\n  alertContainer.style.padding = '10px 3px';\n  alertContainer.style.fontSize = '30px';\n  alertContainer.style.textAlign = 'center';\n  alertContainer.style.backgroundColor = 'red';\n\n  alertContainer.textContent = message;\n\n  document.body.append(alertContainer);\n\n  setTimeout(() => {\n    alertContainer.remove();\n  }, 10000);\n}\n\nexport {showAlert}\n","const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst avatarInput = document.querySelector('#avatar');\nconst avatarPreview = document.querySelector('.ad-form-header__preview').querySelector('img');\nconst photoInput = document.querySelector('#images');\nconst photoPreview = document.querySelector('.ad-form__photo');\nphotoPreview.style.columns = '2';\n\n//Обрабатываем файл аватара загруженный пользователем\navatarInput.addEventListener('change', () => {\n\n  const avatarFile = avatarInput.files[0];\n  const avatarFileName = avatarFile.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return avatarFileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n    reader.addEventListener('load', () => {\n      avatarPreview.src = reader.result;\n    });\n\n    reader.readAsDataURL(avatarFile);\n  }\n});\n\n//Обрабатываем файлы фото жилья загруженные пользователем\nphotoInput.addEventListener('change', () => {\n\n  const photoFile = photoInput.files[0];\n  const photoFileName = photoFile.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return photoFileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n    reader.addEventListener('load', () => {\n      const photoElement = document.createElement('img')\n      photoElement.width = 80;\n      photoElement.height =80;\n      photoElement.src = reader.result;\n\n      photoPreview.appendChild(photoElement);\n\n    });\n\n    reader.readAsDataURL(photoFile);\n    if (photoPreview.children.length > 9){\n      photoInput.setAttribute('disabled', true);\n      document.querySelector('label[for=\"images\"]').textContent ='Хватит =)';\n    }\n\n  }\n\n});\n\nexport {photoPreview, avatarPreview}\n","import {sendData} from './create-fetch.js';\nimport {mainMarker} from './map.js';\nimport {mapFilter, markerBuilder, map} from './map.js';\nimport {avatarPreview, photoPreview} from './file.js'\n\nconst form = document.querySelector('.ad-form');\nconst title = form.querySelector('#title');\nconst type = form.querySelector('#type');\nconst price = form.querySelector('#price');\nconst timeIn = form.querySelector('#timein');\nconst timeOut = form.querySelector('#timeout');\nconst roomNumber = form.querySelector('#room_number');\nconst capacity = form.querySelector('#capacity');\nconst adFormReset = form.querySelector('.ad-form__reset');\n\nconst successMessageTemplate = document.querySelector('#success').content;\nconst successMessage = successMessageTemplate.cloneNode(true);\nconst errorMessageTemplate = document.querySelector('#error').content;\nconst errorMessage = errorMessageTemplate.cloneNode(true);\n\nform.appendChild(errorMessage);\nform.querySelector('.error').classList.add('hidden');\n\nform.appendChild(successMessage);\nform.querySelector('.success').classList.add('hidden');\n\n//условия валидации взяты из ТЗ:\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\nconst MAX_PRICE = 1000000;\n\n//Добавляем тип жилья \"Отель\"\nconst hotelOption = type.options[0].cloneNode(true);\nhotelOption.removeAttribute('selected');\nhotelOption.innerText = 'Отель';\nhotelOption.value = 'hotel';\ntype.insertBefore(hotelOption, type.options[2]);\n\n//Валидируем поле \"Заголовок\" формы\ntitle.addEventListener('input', () => {\n  const valueLength = title.value.length;\n  if (valueLength < MIN_TITLE_LENGTH) {\n    title.setCustomValidity('Ещё ' + (MIN_TITLE_LENGTH - valueLength) +' симв.');\n  } else if(valueLength > MAX_TITLE_LENGTH){\n    title.setCustomValidity('Удалите лишние ' + (valueLength - MAX_TITLE_LENGTH) +' симв.');\n  } else {\n    title.setCustomValidity('');\n  }\n  title.reportValidity();\n});\n\n//Валидируем поле \"Цена за ночь\" в форме\nprice.addEventListener('input', () => {\n  const priceValue = price.value\n  if(priceValue > MAX_PRICE){\n    price.setCustomValidity('Максимальное значение: 1000000');\n  } else {\n    price.setCustomValidity('');\n  }\n  price.reportValidity();\n});\n\n//Устанавливаем зависимость полей количества комнат и количества гостей\ncapacity.addEventListener('input', () => {\n  const roomInputNumber = roomNumber.selectedOptions[0].value;\n  const capacityNumber = capacity.value;\n  if(roomInputNumber < capacityNumber && roomInputNumber !== '100'){\n    capacity.setCustomValidity('Количество гостей должно быть равным или меньшим, чем количество комнат');\n  } else if(roomInputNumber === '100' && capacityNumber !== '0') {\n    capacity.setCustomValidity('В 100 комнат не войдет ни одного гостя =(');\n  }else if(roomInputNumber !== '100' && capacityNumber === '0') {\n    capacity.setCustomValidity('Совсем без гостей будет грустно');\n  }else {\n    capacity.setCustomValidity('');\n  }\n  capacity.reportValidity();\n});\n\n//Меняет минимальное значение и placeholder поля price\nconst minPriceChanger = (min) =>{\n  price.placeholder = min;\n  price.setAttribute('min', min);\n  return price;\n};\n\n//Меняет время въезда\nconst timeInChanger = (time) =>{\n  for (let i = 0; i < timeIn.options.length; i ++) {\n    if (timeIn.options[i].value == time){\n      timeIn.options[i].selected = true;\n    }\n  }\n  return timeIn\n};\n\n//Меняет время выезда\nconst timeOutChanger = (time) =>{\n  for (let i = 0; i < timeOut.options.length; i ++) {\n    if (timeOut.options[i].value == time){\n      timeOut.options[i].selected = true;\n    }\n  }\n  return timeOut\n};\n\n//Вызывает minPriceChanger и передает в него минимум стоимости, соответсвующий типу жилья\ntype.addEventListener('input', () => {\n  const typeSelected = type.selectedOptions[0].value;\n  let min = 0;\n  switch (typeSelected) {\n    case 'flat':\n      min = 1000;\n      break\n\n    case 'hotel':\n      min = 3000;\n      break\n\n    case 'house':\n      min = 5000;\n      break\n\n    case 'palace':\n      min = 10000;\n      break\n  }\n  return minPriceChanger(min);\n},\n);\n\n//При изменении пользователем времени заезда вызывает timeOutChanger и передает в него соответсвущее значение и наоборот\ntimeIn.addEventListener('input', () => {\n  let time = timeIn.selectedOptions[0].value;\n  return timeOutChanger(time)\n})\ntimeOut.addEventListener('input', () => {\n  let time = timeOut.selectedOptions[0].value;\n  return timeInChanger(time)\n})\n\nconst classListToggler = (selector, className) =>{\n  form.querySelector(`.${selector}`).classList.toggle(`${className}`);\n};\n\n//обрабатыеваем полученные от пользователя данные и отправляем на сервер\nform.addEventListener('submit', (evt) => {\n  evt.preventDefault();\n  sendData(\n    //удачно\n    () => {\n      classListToggler('success', 'hidden');\n      window.addEventListener('click', () => {\n        form.querySelector('.success').classList.add('hidden');\n      })\n      window.addEventListener('keydown', (evt) => {\n        if (evt.key === 'Escape' || evt.key === 'Esc'){\n          form.querySelector('.success').classList.add('hidden');\n        }\n      })\n      form.reset();\n      avatarPreview.src = 'img/muffin-grey.svg';\n      photoPreview.textContent = '';\n      mapFilter.reset();\n      mainMarker._latlng.lat = 35.68950;\n      mainMarker._latlng.lng = 139.6920;\n      mainMarker.update();\n      map.setView({\n        lat: 35.6895,\n        lng: 139.692,\n      }, 14);\n      markerBuilder();\n    },\n    //с ошибкой\n    (err) => {\n      if(err === 'Failed to fetch'){\n        err = 'Сервис временно недоступен. Пожалуйста попробуйте ещё раз позже.';\n      }\n      form.querySelector('.error__message').append(`. ${err}`);\n      classListToggler('error', 'hidden');\n      form.querySelector('.error__button').addEventListener('click', () => {\n        classListToggler('error', 'hidden');\n      });\n      window.addEventListener('click', () => {\n        form.querySelector('.error__message').innerText = 'Ошибка размещения объявления';\n        form.querySelector('.error').classList.add('hidden');\n      })\n      window.addEventListener('keydown', (evt) => {\n        if (evt.key === 'Escape' || evt.key === 'Esc'){\n          form.querySelector('.error__message').innerText = 'Ошибка размещения объявления';\n          form.querySelector('.error').classList.add('hidden');\n        }\n      });\n\n    },\n    new FormData(evt.target),\n  );\n});\n\n//возвращаем метку и значения адреса в начльное положение при нажатии кнокпи очистить\nadFormReset.addEventListener('click', (evt) =>{\n  evt.preventDefault();\n  form.reset();\n  mapFilter.reset();\n  avatarPreview.src = 'img/muffin-grey.svg';\n  photoPreview.textContent = '';\n  mainMarker._latlng.lat = 35.68950;\n  mainMarker._latlng.lng = 139.6920;\n  mainMarker.update();\n  map.setView({\n    lat: 35.6895,\n    lng: 139.692,\n  }, 14);\n  markerBuilder();\n})\n"],"names":["AdsNearbyTemplate","document","querySelector","content","defaultValue","housingTypeElement","housingPriceElement","housingRoomsElement","housingGuestsElement","housingFeaturesElement","checkHousingType","ad","value","offer","type","checkHousingPrice","price","checkHousingRooms","String","rooms","checkHousingGuests","guests","checkHousingFeatures","checkedFeatures","querySelectorAll","checkedList","forEach","input","push","length","Object","keys","includes","offerFeatures","features","every","feature","adForm","mapFilter","map","L","on","setView","lat","lng","tileLayer","attribution","addTo","mainMarkerIcon","icon","iconUrl","iconSize","iconAnchor","mainMarker","marker","draggable","evt","x","target","getLatLng","y","toFixed","markerBuilder","_","debounce","onSuccess","adsNearby","filtredAds","ads","filteredAds","filterAds","nearbyMarkerIcon","location","bindPopup","adNearby","adsNearbyListElement","cloneNode","textContent","title","address","checkin","checkout","element","remove","undefined","i","featureOne","createElement","classList","add","appendChild","description","photos","photoOne","src","width","height","alt","author","avatar","children","createPopup","addEventListener","onError","message","alertContainer","style","zIndex","position","left","top","right","padding","fontSize","textAlign","backgroundColor","body","append","setTimeout","showAlert","fetch","then","response","ok","json","Error","status","statusText","catch","window","FILE_TYPES","avatarInput","avatarPreview","photoInput","photoPreview","columns","avatarFile","files","avatarFileName","name","toLowerCase","some","it","endsWith","reader","FileReader","result","readAsDataURL","photoFile","photoFileName","photoElement","setAttribute","timeIn","timeOut","roomNumber","capacity","adFormReset","successMessage","errorMessage","hotelOption","options","removeAttribute","innerText","insertBefore","valueLength","setCustomValidity","reportValidity","roomInputNumber","selectedOptions","capacityNumber","min","placeholder","minPriceChanger","time","selected","timeOutChanger","timeInChanger","classListToggler","selector","className","toggle","onFail","preventDefault","err","key","FormData","method","reset","_latlng","update"],"sourceRoot":""}